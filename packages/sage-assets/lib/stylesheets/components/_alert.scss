////
/// Alert
///
/// @group sage
////

//
// NOTE: These colors maps have corresponding settings in the following:
// `_button.scss`, `sage_alert.rb`, `_sage_alert.html.erb`, and `Alert.jsx`
//
$-alert-background-colors: (
  default: var(--pine-color-grey-200),
  draft: var(--pine-color-grey-200),
  info: var(--pine-color-blue-150),
  published: var(--pine-color-green-150),
  success: var(--pine-color-green-150),
  warning: var(--pine-color-yellow-150),
  approaching: var(--pine-color-yellow-150),
  reached: var(--pine-color-mercury-150),
  exceeded: var(--pine-color-red-150),
  danger: var(--pine-color-red-150),
);

$-alert-icon-colors: (
  default: var(--pine-color-grey-700),
  draft: var(--pine-color-grey-700),
  info: var(--pine-color-blue-700),
  published: var(--pine-color-success),
  success: var(--pine-color-success),
  warning: var(--pine-color-warning),
  approaching: var(--pine-color-warning),
  reached: var(--pine-color-mercury-800),
  exceeded: var(--pine-color-danger),
  danger: var(--pine-color-danger),
);

$-alert-border-colors: (
  default: var(--pine-color-grey-300),
  draft: var(--pine-color-grey-300),
  info: var(--pine-color-blue-300),
  published: var(--pine-color-green-300),
  success: var(--pine-color-green-300),
  warning: var(--pine-color-yellow-300),
  approaching: var(--pine-color-yellow-300),
  reached: var(--pine-color-mercury-300),
  exceeded: var(--pine-color-red-300),
  danger: var(--pine-color-red-300),
);

$-alert-text-colors: (
  default: --pine-color-grey-900,
  draft: --pine-color-grey-900,
  info: --pine-color-blue-900,
  published: --pine-color-green-800,
  success: --pine-color-green-800,
  warning: --pine-color-yellow-900,
  approaching: --pine-color-yellow-900,
  reached: --pine-color-grey-900,
  exceeded: --pine-color-red-900,
  danger: --pine-color-red-900,
);

.sage-alert {
  --sage-alert-color-text: var(--pine-color-grey-900);
  display: grid;
  grid-template-columns: auto 1fr;
  grid-template-areas: "icon copy";
  gap: sage-spacing(sm);
  padding: sage-spacing();
  margin-block-end: sage-spacing();
  border: var(--pine-border);
  border-radius: sage-border(radius-large);

  .sage-frame > &,
  .sage-panel > & {
    margin-block-end: 0;
  }

  &.sage-alert--actions {
    grid-template-areas:
      "icon copy"
      ".    actions";
  }

  &.sage-alert--dismissable {
    grid-template-columns: auto 1fr auto;
    grid-template-areas: "icon copy    close";

    &.sage-alert--actions {
      grid-template-areas:
        "icon copy    close"
        ".    actions .";
    }
  }
}

@each $name, $value in $-alert-background-colors {
  .sage-alert--#{$name} {
    background-color: $value;
  }
}

@each $name, $value in $-alert-border-colors {
  .sage-alert--#{$name} {
    border-color: $value;
  }
}

@each $name, $value in $-alert-text-colors {
  .sage-alert--#{$name} {
    --sage-alert-color-text: var(#{$value});
  }
}

.sage-alert--small {
  grid-template-columns: auto 1fr auto;
  grid-template-areas: "icon copy actions";
  align-items: center;
  padding: sage-spacing(sm);
  border-radius: sage-border(radius-medium);

  &.sage-alert--dismissable {
    grid-template-columns: auto 1fr auto auto;
    grid-template-areas: "icon copy actions close";

    &.sage-alert--actions {
      grid-template-areas: "icon copy actions close";
    }
  }

  &.sage-alert--actions {
    grid-template-areas: "icon copy actions";
  }
}

.sage-alert__copy {
  @include sage-grid-stack();
}

.sage-alert__title {
  @extend %t-sage-heading-5;

  .sage-alert & {
    color: var(--sage-alert-color-text);
  }
}

.sage-alert__title--add-on {
  @extend %t-sage-body-small;
}

.sage-alert__icon {
  grid-area: icon;
  transform: translateY(4px);

  @each $name, $value in $-alert-icon-colors {
    .sage-alert--#{$name} & {
      color: $value;
    }
  }

  .sage-alert--small & {
    transform: translateY(0);
  }
}

.sage-alert__close {
  grid-area: close;
  transform: translateY(4px);

  .sage-alert--small & {
    transform: translateY(2px);
  }
}

.sage-alert__actions {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: sage-spacing();
  grid-area: actions;

  // Mimics sage-link "plain link" styling
  // Excludes elements styled by Sage
  // such as SageLink and SageButton
  a:not([class*="sage-"]) {
    @extend %t-sage-body-med;
    @include sage-focus-outline($outline-offset-inline: 4px);

    color: var(--pine-color-grey-900);
    text-decoration: none;

    &:hover {
      color: var(--pine-color-grey-950);
      text-decoration: underline;
    }

    &:focus-visible {
      @include sage-focus-outline--update-color(var(--pine-color-purple-600));
    }
  }

  .sage-alert--small & {
    gap: sage-spacing(sm);
  }
}

.sage-alert__desc {
  @extend %t-sage-body;
  color: var(--sage-alert-color-text);

  // Mimics sage-link "inline link" styling
  // Excludes elements styled by Sage
  // such as SageLink and SageButton
  a:not([class*="sage-"]) {
    @include sage-focus-outline($outline-offset-inline: 4px);

    color: var(--pine-color-grey-900);
    text-decoration: underline;

    &:hover {
      color: var(--pine-color-grey-950);
      text-decoration: none;
    }

    &:focus-visible {
      @include sage-focus-outline--update-color(var(--pine-color-purple-600));
    }
  }

  .sage-alert--small & {
    @include truncate();
    max-width: 100%;
  }
}
