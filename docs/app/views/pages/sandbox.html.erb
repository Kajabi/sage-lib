<%
data = {
  upsells: [
    {
      title: "Upsell Title",
      price: "$10.00 USD",
      downsell: {
        title: "Downsell Title",
        price: "$10.00 USD"
      }
    },
    {
      title: "Upsell Title 2",
      price: "$12.00 USD",
      downsell: nil
    }
  ]
}
upsell_items = [
  {
    value: "Preview",
    icon: "preview-on",
    attributes: {
      "href": "#",
    },
  },
  {
    value: "Remove",
    icon: "remove-circle",
    attributes: {
      "href": "#",
    },
    style: "danger",
  }
]
upsell_items_full = [
  {
    value: "Preview",
    icon: "preview-on",
    attributes: {
      "href": "#",
    },
  },
  {
    value: "Add Downsell",
    icon: "arrow-corner",
    attributes: {
      "href": "#",
    },
  },
  {
    value: "Remove",
    icon: "remove-circle",
    attributes: {
      "href": "#",
    },
    style: "danger",
  },
]
status_items = [
  {
    value: "Active",
  },
  {
    value: "Inactive",
  },
]
%>
<%= sage_component SageFormSection, {
  title: "Upsells",
  subtitle: "An Upsell is an additional and optional Offer that members can also purchase. It is prompted to members after they finish purchasing your initial Offer.",
} do %>
  <%= sage_component SagePanelHeader, { title: "After-purchase flow", spacer: { bottom: :xs } } %>
  <%= sage_component SagePanelDivider, { label: "After checkout" } %>
  <%= sage_component SageSortable, {
    resource_name: "upsells",
    spacer: { top: :sm }
  } do %>
    <% data[:upsells].each do | upsell | %>
      <%= sage_component SageSortableItemCustom, { css_classes: "upsell__custom-sortable" } do %>
        <%= sage_component SageCard, {
          clear_bottom_padding: true,
          clear_top_padding: true,
        } do %>
          <%= sage_component SageCardList, {} do %>
            <%= sage_component SageCardListItem, {} do %>
              <%= sage_component SageCardHeader, {
                title: "Upsell offer",
                spacer: { bottom: :xs }
              } %>
              <%= sage_component SageCardRow, { grid_template: "eti", spacer: { bottom: :xs } }  do %>
                <div class="upsell__graphic">
                  <%= sage_component SageIcon, { icon: "image", color: "grey-500", size: "3xl" } %>
                </div>
                <div class="<%= SageClassnames::TYPE::BODY %>">
                  <h2><%= link_to upsell[:title], "#", class: SageClassnames::TYPE::BODY_SEMI %></h2>
                  <p class="<%= SageClassnames::TYPE_COLORS::CHARCOAL_100 %>"><%= upsell[:price] %></p>
                </div>
                <%= sage_component SageDropdown, {
                  align: "right",
                  panel_size: "small",
                  items: status_items,
                } do %>
                  <%= sage_component SageLabel, {
                    color: "published",
                    interactive_type: :dropdown,
                    value: "Active",
                  } %>
                <% end %>
                <%= sage_component SageDropdown, {
                  align: "right",
                  items: upsell[:downsell] ? upsell_items : upsell_items_full,
                } do %>
                  <%= sage_component SageButton, {
                    style: "secondary",
                    icon: { name: "dot-menu-horizontal", style: "only" },
                    value: "Options",
                    align: "end",
                    subtle: true,
                  } %>
                <% end %>
              <% end %>
              <% if !upsell[:downsell] %>
                <%= sage_component SageCardRow, { grid_template: "et", spacer: { top: :xs } }  do %>
                  <div class="upsell__add-downsell-icon">
                    <%= sage_component SageIcon, { icon: "downsell" } %>
                  </div>
                  <%= sage_component SageButton, {
                    style: "primary",
                    subtle: true,
                    value: "Add downsell",
                  } %>
                <% end %>
              <% end %>
            <% end %>
            <% if upsell[:downsell] %>
              <%= sage_component SageCardListItem, {} do %>
                <%= sage_component SageCardHeader, {
                  title: "Downsell offer",
                  spacer: { bottom: :xs }
                } %>
                <%= sage_component SageCardRow, { grid_template: "iti", spacer: { bottom: :xs } }  do %>
                  <div class="upsell__add-downsell-icon">
                    <%= sage_component SageIcon, { icon: "downsell" } %>
                  </div>
                  <div class="upsell__graphic">
                    <%= sage_component SageIcon, { icon: "image", color: "grey-500", size: "3xl" } %>
                  </div>
                  <div class="<%= SageClassnames::TYPE::BODY %>">
                    <h2><%= link_to upsell[:downsell][:title], "#", class: SageClassnames::TYPE::BODY_SEMI %></h2>
                    <p class="<%= SageClassnames::TYPE_COLORS::CHARCOAL_100 %>"><%= upsell[:downsell][:price] %></p>
                  </div>
                  <%= sage_component SageDropdown, {
                      align: "right",
                      panel_size: "small",
                      items: status_items,
                    } do %>
                    <%= sage_component SageLabel, {
                      color: "published",
                      interactive_type: :dropdown,
                      value: "Active",
                    } %>
                  <% end %>
                  <%= sage_component SageDropdown, {
                    align: "right",
                    items: upsell[:downsell] ? upsell_items : upsell_items_full,
                  } do %>
                    <%= sage_component SageButton, {
                      style: "secondary",
                      icon: { name: "dot-menu-horizontal", style: "only" },
                      value: "Options",
                      align: "end",
                      subtle: true,
                    } %>
                  <% end %>
                <% end %>
              <% end %>
            <% end %>
          <% end %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>
  <div class="<%= SageClassnames::TYPE_ALIGN_CENTER %>">
    <%= sage_component SageButton, {
        spacer: { top: :md, bottom: :md },
        value: "Add an Upsell",
        style: "secondary",
        raised: false,
      } %>
  </div>
  <%= sage_component SagePanelDivider, { label: "End of flow" } %>
<% end %>
<%= sage_component SagePanelDivider, {} %>
<%= sage_component SageButton, {
  spacer: { top: :sm },
  value: "Clear all",
  style: "danger",
  subtle: true,
  icon: {
    style: "left",
    name: "trash"
  },
} %>
