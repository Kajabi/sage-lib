/* ==================================================
  ** _colors.scss

  For Sage documentation use
================================================== */

// ==================================================
// MIXINS
// ==================================================

// color block groupings
.colors {
  overflow: hidden;
  margin-block-start: sage-spacing();
  margin-block-end: sage-spacing();
  border-radius: sage-border(radius);
}

.colors__block {
  display: flex;
  flex-flow: column nowrap;
  align-items: center;
  justify-content: space-between;

  @media screen and (min-width: sage-breakpoint(lg-min)) {
    flex-direction: row;
  }
}

.colors__tokens {
  code {
    background-color: transparent;
  }
}

.colors__tokens-heading,
.colors__copy-btn,
.colors__copy-btn::before {
  .colors__classname-token &,
  .colors__hex-token & {
    color: inherit;
  }
}

// build individual color blocks
@each $name, $color in $sage-colors {
  // Skip if $color is not a map (handles aliases like primary, sage, orange, charcoal)
  @if type-of($color) == map {
    @each $value, $map in $color {
      // Skip if $map is null or not a map (safety check)
      @if $map != null and type-of($map) == map {
        // Use sage-color-hex() for SCSS operations (lightness() requires actual color values)
        $hex: sage-color-hex($name, $value);

        // Determine class name for $value == 50
        $classname: ".color-#{"" + $name}-#{$value}";

        /* en-disable max-nesting-depth block-closing-brace-newline-after */
        // This should be numeric, not string
        @if ($value == 50) {
          $classname: ".color-#{"" + $name}-0#{$value}";
        }

        #{$classname} {
          padding: sage-spacing(sm) sage-spacing();
          font-size: sage-font-size(body);
          background: $hex;

          // Use lightness-based logic for dynamic contrast (prioritized for better readability)
          // If background is dark (lightness < 65%), use light text; otherwise use dark text
          @if (lightness($hex) < 65) {
            // Dark background → use light text color
            @if ($name == white) {
              color: sage-color(black);
            } @else if ($name == grey or $name == black or $name == charcoal) {
              color: sage-color(white);
            } @else {
              // For colored backgrounds, use the lightest shade (100) or white
              color: sage-color($name, 100);
            }
          } @else {
            // Light background → use dark text color
            @if ($name == white) {
              color: sage-color(grey, 950);
            } @else if ($name == black or $name == charcoal) {
              color: sage-color(white);
            } @else if ($name == grey) {
              color: sage-color(grey, 950);
            } @else {
              // For colored backgrounds, use a darker shade (400+) for contrast
              color: sage-color($name, 400);
            }
          }

          &::after {
            content: "#{$hex}";
            padding-inline-start: sage-spacing(xs);
            font-weight: sage-font-weight(semibold);
            text-transform: uppercase;
          }
        }
        /* en-enable max-nesting-depth block-closing-brace-newline-after */
      }
    }
  }
}

[class*="color-"]:only-child {
  border-radius: sage-border(radius);
}

.color-white-100 {
  border-radius: sage-border(radius);
  border: 1px solid sage-color(grey, 800);
  box-shadow: inset 0 0 0.0625rem sage-color(grey, 800);
}

.color-black-100 {
  color: sage-color(white);
}
